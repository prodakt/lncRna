% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/trans.R
\name{calculateTransInteractions}
\alias{calculateTransInteractions}
\title{Estimate Trans-Acting Interactions Based on Expression Correlation}
\usage{
calculateTransInteractions(
  exprMatrix,
  corMethod = "pearson",
  rValueCutoff = 0.7,
  pValueCutoff = 0.05,
  lncRnaIds = NULL,
  targetRnaIds = NULL,
  fullCorrMatrixFile = NULL
)
}
\arguments{
\item{exprMatrix}{A numeric matrix of expression values, where rows are genes
(or transcripts) and columns are samples. Rownames must be gene identifiers.}

\item{corMethod}{The correlation method to use, either "pearson" (default) or
"spearman".}

\item{rValueCutoff}{The absolute correlation coefficient cutoff. Interactions
with an |r-value| greater than or equal to this are retained. Defaults to 0.7.}

\item{pValueCutoff}{The p-value cutoff. Interactions with a p-value less than
this are retained. Defaults to 0.05.}

\item{lncRnaIds}{A character vector of lncRNA identifiers. These must match
rownames in \code{exprMatrix}. If \code{NULL} (default), all genes are considered
potential lncRNAs.}

\item{targetRnaIds}{A character vector of target gene identifiers. These must
match rownames in \code{exprMatrix}. If \code{NULL} (default), all genes are
considered potential targets.}

\item{fullCorrMatrixFile}{An optional character string specifying a file path
to save the complete, unfiltered correlation matrix.}
}
\value{
A data.frame containing significant trans-interactions with columns:
\code{lncRNAId}, \code{targetRNAId}, \code{rValue}, and \code{pValue}.
}
\description{
This function estimates trans-interactions between lncRNAs and potential
target genes by calculating expression correlation. It uses the \code{Hmisc}
package for efficient correlation and p-value computation.
}
\examples{
# --- 1. Create a sample expression matrix for a reproducible example ---
set.seed(123)
sampleExprMatrix <- matrix(
  rnorm(50), nrow = 5,
  dimnames = list(
    c("LNC_1", "LNC_2", "GENE_A", "GENE_B", "GENE_C"), # Rownames are gene IDs
    paste0("Sample_", 1:10)                             # Colnames are sample IDs
  )
)
# Introduce a strong correlation for demonstration
sampleExprMatrix["LNC_1",] <- sampleExprMatrix["GENE_A",] + rnorm(10, 0, 0.1)

# --- 2. Define lncRNA and target gene lists ---
lncIds <- c("LNC_1", "LNC_2")
targetIds <- c("GENE_A", "GENE_B", "GENE_C")

# --- 3. Run the analysis ---
if (requireNamespace("Hmisc", quietly = TRUE) &&
    requireNamespace("reshape2", quietly = TRUE)) {
  transInteractions <- calculateTransInteractions(
    exprMatrix = sampleExprMatrix,
    rValueCutoff = 0.9,
    lncRnaIds = lncIds,
    targetRnaIds = targetIds
  )
  print(transInteractions)

  # --- 4. Example of saving the full correlation matrix to a temporary file ---
  tempFile <- tempfile(fileext = ".tsv")
  calculateTransInteractions(
    exprMatrix = sampleExprMatrix,
    lncRnaIds = lncIds,
    targetRnaIds = targetIds,
    fullCorrMatrixFile = tempFile
  )
  # In a real session, you could inspect this file.
  unlink(tempFile) # Clean up
}
}
