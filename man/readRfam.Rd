% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/readRfam.R
\name{readRfam}
\alias{readRfam}
\title{Read and Filter an Rfam hmmscan Result File}
\usage{
readRfam(rfamOutfile, evalCutoff = 0.01)
}
\arguments{
\item{rfamOutfile}{A character string specifying the path to the hmmscan
\code{domtblout} output file.}

\item{evalCutoff}{A numeric value for the sequence e-value cutoff. Hits with
an e-value less than this threshold will be retained. Defaults to 1e-2.}
}
\value{
A unique character vector of query names that pass the e-value
filter.
}
\description{
This function reads a \code{domtblout} file from an hmmscan search against the
Rfam database, filters the results by an e-value cutoff, and returns a unique
list of query names that pass the filter.
}
\examples{
# --- 1. Create a temporary dummy domtblout file for a reproducible example ---
tempRfamFile <- tempfile()

# Create content mimicking the space-delimited domtblout format.
# We only need to populate columns 4 (query_name) and 12 (sequence_evalue).
filler <- paste(rep("-", 20), collapse = " ")
fileContent <- c(
  "# Dummy Rfam domtblout file for example",
  paste("RF00005", "-", "-", "Seq_A", filler, "1.0e-5", "-"), # Should pass
  paste("RF00017", "-", "-", "Seq_A", filler, "2.0e-4", "-"), # Should pass (duplicate query)
  paste("RF00001", "-", "-", "Seq_B", filler, "9.0e-1", "-"), # Should be filtered out
  paste("RF00002", "-", "-", "Seq_C", filler, "5.0e-3", "-")  # Should pass
)

# Write the content to the temporary file
writeLines(fileContent, tempRfamFile)

# --- 2. Run the readRfam function ---
if (requireNamespace("rhmmer", quietly = TRUE)) {
  passingQueries <- readRfam(rfamOutfile = tempRfamFile, evalCutoff = 1e-2)
  print("Unique query names passing the e-value cutoff:")
  print(passingQueries) # Expected output: c("Seq_A", "Seq_C")
}

# --- 3. Clean up the temporary file ---
unlink(tempRfamFile)

}
\keyword{hmmscan}
\keyword{lncRNA}
\keyword{rfam}
\keyword{rhmmer}
